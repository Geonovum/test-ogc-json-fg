<!DOCTYPE html><html lang="en"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 34.1.4">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
  
  
  
  
<script>document.title = respecConfig.title</script>
<title>Testing OGC JSON-FG Draft Specification and its GDAL-DEV Implementation</title>
  
<title>TODO: Vul hier de titel in</title>
  
<link rel="shortcut icon" type="image/x-icon" href="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.ico">
  
  
  
<style>
div.imageinfo img {max-width: none;}
</style>

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px}
</style>
<style>
ul.index{columns:30ch;column-gap:1.5em}
ul.index li{list-style:inherit}
ul.index li span{color:inherit;cursor:pointer;white-space:normal}
#index-defined-here ul.index li{font-size:.9rem}
ul.index code{color:inherit}
#index-defined-here .print-only{display:none}
@media print{
#index-defined-here .print-only{display:initial}
}
</style>
<meta name="description" content="We use this repository to document the test scenarios and test results of the">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #FF0000;
  }
</style>
<script type="text/javascript">
   /* Any custom mermaid.js scripts will go here. */
  </script>
<style>

  /* Any custom mermaid.js scripts will go here. */
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Geonovum",
  "nl_organisationPublishURL": "https://docs.geostandaarden.nl/",
  "logos": [
    {
      "src": "https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg",
      "alt": "Geonovum",
      "id": "Geonovum",
      "height": 67,
      "width": 132,
      "url": "https://www.geonovum.nl/geo-standaarden"
    }
  ],
  "postProcess": [
    null
  ],
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "specStatus",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "publishDate"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "previousMaturity",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "previousPublishDate"
  ],
  "useLogo": true,
  "useLabel": true,
  "license": "cc-by",
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Editor's draft",
      "cv": "Candidate recommendation",
      "vv": "Proposed recommendation",
      "def": "Recommendation",
      "basis": "Document",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Practical guideline",
      "hr": "Guide",
      "wa": "Work process agreement",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen stabiel document.",
      "cv": "Dit is een consultatieversie. Commentaar over dit document kan gestuurd worden naar ",
      "vv": "Dit is de definitieve conceptversie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of this document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a working draft that can be changed, removed or replaced by other documents at any time. It is not a stable document.",
      "cv": "This is a stable draft, published for public comment. Comments regarding this document may be sent to ",
      "vv": "This is the final draft of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#045D9F",
    "wv": "#FF0000",
    "cv": "#045D9F",
    "vv": "#045D9F",
    "basis": "#80CC28"
  },
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/CC-Licentie.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by-nd.svg"
    }
  },
  "localBiblio": {
    "SemVer": {
      "href": "https://semver.org",
      "title": "Semantic Versioning 2.0.0",
      "authors": [
        "T. Preston-Werner"
      ],
      "date": "June 2013"
    }
  },
  "title": "Testing OGC JSON-FG Draft Specification and its GDAL-DEV Implementation",
  "specStatus": "wv",
  "specType": "AL",
  "pubDomain": "test-ogc-json-fg",
  "licence": "cc-by",
  "shortName": "test-ogc-json-fg",
  "editors": [
    {
      "name": "voornaam achternaam",
      "company": "Geonovum",
      "companyURL": "https://www.geonovum.nl"
    }
  ],
  "authors": [
    {
      "name": "voornaam achternaam",
      "company": "Geonovum",
      "companyURL": "https://www.geonovum.nl"
    }
  ],
  "github": "https://github.com/Geonovum/test-ogc-json-fg"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css"></head>

<body class="h-entry"><div class="head">
    <a class="logo" href="https://www.geonovum.nl/geo-standaarden"><img alt="Geonovum" height="67" id="Geonovum" src="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg" width="132">
  </a> <h1 id="title" class="title">Testing OGC JSON-FG Draft Specification and its GDAL-DEV Implementation</h1>
    
    <h2>
      Geonovum General<br>
      Editor's draft
      <time class="dt-published" datetime="2023-10-31">October 31, 2023</time>
    </h2>
    <dl>
      
      
      <dt>Latest editor's draft:</dt><dd><a href="https://geonovum.github.io/test-ogc-json-fg/">https://geonovum.github.io/test-ogc-json-fg/</a></dd>
      
      
      
      
      
      <dt>Editor:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">voornaam achternaam</span> (<a class="p-org org h-org" href="https://www.geonovum.nl">Geonovum</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">voornaam achternaam</span> (<a class="p-org org h-org" href="https://www.geonovum.nl">Geonovum</a>)
  </dd>
      <dt>Participate:</dt><dd>
    <a href="https://github.com/Geonovum/test-ogc-json-fg/">GitHub Geonovum/test-ogc-json-fg</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/test-ogc-json-fg/issues/">File an issue</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/test-ogc-json-fg/commits/">Commit history</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/test-ogc-json-fg/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    
    <p class="copyright">
          This document is licensed under 
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2><p>We use this repository to document the test scenarios and test results of the</p>
<p>OGC Features and Geometries JSON - Part 1: Core DRAFT SPECIFICATION
<a href="https://docs.ogc.org/DRAFTS/21-045.html#_overview">https://docs.ogc.org/DRAFTS/21-045.html#_overview</a></p>
<p>and its implementation in GDAL GDAL
3.8.0dev-d054405d9e063595400469128e142bd80bb71923, released 2023/09/16</p>
<p>as part of the OGC open standards code sprint, London, October 30 - November 1,
2023
<a href="https://developer.ogc.org/sprints/22/#:~:text=When%20is%20the%20code%20sprint,be%20held%20on%20October%2C%2012">https://developer.ogc.org/sprints/22/#:~:text=When%20is%20the%20code%20sprint,be%20held%20on%20October%2C%2012</a>.</p>
</section>
  <section id="sotd" class="introductory"><h2>Status of this document</h2><p>This is a working draft that can be changed, removed or replaced by other documents at any time. It is not a stable document.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of this document</a></li><li class="tocline"><a class="tocxref" href="#about-json-fg"><bdi class="secno">1. </bdi>About JSON-FG</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#temporal-information"><bdi class="secno">1.1 </bdi>Temporal information</a></li><li class="tocline"><a class="tocxref" href="#additional-geometry-types"><bdi class="secno">1.2 </bdi>Additional geometry types</a></li><li class="tocline"><a class="tocxref" href="#coordinate-reference-systems"><bdi class="secno">1.3 </bdi>Coordinate reference systems</a></li><li class="tocline"><a class="tocxref" href="#feature-types-and-feature-schema"><bdi class="secno">1.4 </bdi>Feature types and feature schema</a></li></ol></li><li class="tocline"><a class="tocxref" href="#about-the-gdal-implementation-of-json-fg"><bdi class="secno">2. </bdi>About the GDAL implementation of JSON-FG</a></li><li class="tocline"><a class="tocxref" href="#test-scenarios"><bdi class="secno">3. </bdi>Test scenarios</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#draft-specification"><bdi class="secno">3.1 </bdi>Draft specification</a></li><li class="tocline"><a class="tocxref" href="#gdal-dev-implementation"><bdi class="secno">3.2 </bdi>GDAL-dev implementation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#formats-json-fg"><bdi class="secno">3.2.1 </bdi>Formats JSON-FG &lt;&gt;:</a></li></ol></li><li class="tocline"><a class="tocxref" href="#test-execution"><bdi class="secno">3.3 </bdi>Test execution</a></li></ol></li><li class="tocline"><a class="tocxref" href="#results"><bdi class="secno">4. </bdi>Results</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#geometry-and-place"><bdi class="secno">4.1 </bdi>Geometry and place</a></li><li class="tocline"><a class="tocxref" href="#time"><bdi class="secno">4.2 </bdi>Time</a></li><li class="tocline"><a class="tocxref" href="#featuretype-and-schema"><bdi class="secno">4.3 </bdi>featureType and schema</a></li><li class="tocline"><a class="tocxref" href="#x3d-geometries"><bdi class="secno">4.4 </bdi>3D geometries</a></li><li class="tocline"><a class="tocxref" href="#sample-output"><bdi class="secno">4.5 </bdi>Sample output</a></li><li class="tocline"><a class="tocxref" href="#client-tests"><bdi class="secno">4.6 </bdi>Client tests</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">5. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#index"><bdi class="secno">A. </bdi>Index</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#index-defined-here"><bdi class="secno">A.1 </bdi>Terms defined by this specification</a></li><li class="tocline"><a class="tocxref" href="#index-defined-elsewhere"><bdi class="secno">A.2 </bdi>Terms defined by reference</a></li></ol></li></ol></nav>

  
  <section class="informative" id="about-json-fg"><div class="header-wrapper"><h2 id="x1-about-json-fg"><bdi class="secno">1. </bdi>About JSON-FG</h2><a class="self-link" href="#about-json-fg" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
<p>OGC Features and Geometries JSON (JSON-FG) is a proposal for extending GeoJSON
with support for a.o.</p>
<ol>
<li><p>Temporal information</p>
</li>
<li><p>Additional geometry types</p>
</li>
<li><p>Coordinate reference systems (CRS) other than WGS84</p>
</li>
<li><p>Metadata about the feature types in a feature collection, using feature
schemas</p>
</li>
</ol>
<p>We test the JSON-FG draft specification and implementation on these components.</p>
<section id="temporal-information"><div class="header-wrapper"><h3 id="x1-1-temporal-information"><bdi class="secno">1.1 </bdi>Temporal information</h3><a class="self-link" href="#temporal-information" aria-label="Permalink for Section 1.1"></a></div>
<p>JSON-FG adds to GeoJSON a standardized method to include temporal aspects for
feature instances: date, time, and interval.</p>
</section><section id="additional-geometry-types"><div class="header-wrapper"><h3 id="x1-2-additional-geometry-types"><bdi class="secno">1.2 </bdi>Additional geometry types</h3><a class="self-link" href="#additional-geometry-types" aria-label="Permalink for Section 1.2"></a></div>
<p>GeoJSON only supports a limited number of geometry types in the
geometry-attribute: (MULTI)POINT, (MULTI)LINE, (MULTI)POLYGON and
GEOMETRYCOLLECTION. JSON-FG extends GeoJSON with 3D solid geometry to include
(MULTI)POLYHEDRON and (MULTI)PRISM in a separate <em>place</em> attribute.</p>
</section><section id="coordinate-reference-systems"><div class="header-wrapper"><h3 id="x1-3-coordinate-reference-systems"><bdi class="secno">1.3 </bdi>Coordinate reference systems</h3><a class="self-link" href="#coordinate-reference-systems" aria-label="Permalink for Section 1.3"></a></div>
<p>GeoJSON formally allows only geometry in the WGS'84 CRS to be included in the
<em>geometry</em> attribute. JSON-FG makes it possible to include geometry in other CRS
in a separate <em>place</em> attribute.</p>
</section><section id="feature-types-and-feature-schema"><div class="header-wrapper"><h3 id="x1-4-feature-types-and-feature-schema"><bdi class="secno">1.4 </bdi>Feature types and feature schema</h3><a class="self-link" href="#feature-types-and-feature-schema" aria-label="Permalink for Section 1.4"></a></div>
<p>JSON-FG describes how to add knowledge about the feature type in a feature
collection, both homogeneous and heterogeneous in terms of the feature types,
using for example feature schemas.</p>
</section></section>
  <section class="informative" id="about-the-gdal-implementation-of-json-fg"><div class="header-wrapper"><h2 id="x2-about-the-gdal-implementation-of-json-fg"><bdi class="secno">2. </bdi>About the GDAL implementation of JSON-FG</h2><a class="self-link" href="#about-the-gdal-implementation-of-json-fg" aria-label="Permalink for Section 2."></a></div><p><em>This section is non-normative.</em></p>
<p>At the time of testing, the JSON-FG driver is not yet part of a release but is merged into GDAL master. </p>
<p>It can be for example tested using the -latest docker images mentioned at <a href="https://github.com/OSGeo/gdal/tree/master/docker">https://github.com/OSGeo/gdal/tree/master/docker</a></p>
<p>e.g</p>
<pre aria-busy="false"><code class="hljs javascript">$ docker run --rm -it ghcr.io/osgeo/gdal:alpine-small-latest ogrinfo --format jsonfg
Format Details:
  Short Name: JSONFG
  Long Name: OGC Features and Geometries <span class="hljs-built_in">JSON</span>
  <span class="hljs-attr">Supports</span>: Vector
  <span class="hljs-attr">Extension</span>: json
  Help Topic: drivers/vector/jsonfg.html</code></pre>

<p>Or using Conda and the gdal-master channel. Instructions at <a href="https://gdal.org/download.html#gdal-master-conda-builds">https://gdal.org/download.html#gdal-master-conda-builds</a></p>
<p>We use the first method. </p>
<p>Documentation of the GDAL JSON-FG driver is here: <a href="https://gdal.org/drivers/vector/jsonfg.html">https://gdal.org/drivers/vector/jsonfg.html</a></p>
<p>GDAL implements the following features of JSON-FG: </p>
<ul>
<li>capturing the feature type in a featureType element to affect features to separate</li>
<li>capturing a coordinate reference system (not necessarily WGS 84) in a coordRefSys element, that is the one used by geometries written in the place element</li>
<li>time element at Feature level</li>
<li>minimum support for Polyhedron geometries (with a single outer shell) and Prism with Point, LineString or Polygon base.</li>
</ul>
</section>
  <section class="informative" id="test-scenarios"><div class="header-wrapper"><h2 id="x3-test-scenarios"><bdi class="secno">3. </bdi>Test scenarios</h2><a class="self-link" href="#test-scenarios" aria-label="Permalink for Section 3."></a></div><p><em>This section is non-normative.</em></p>
<p>TODO: collect test cases, resultats etc in Excel spreadsheet.</p>
<p>For example:</p>
<p>N.B. THIS IS AN EXAMPLE SPREADSHEET AND DOES NOT CONTAIN TRUE TEST RESULTS.</p>
<table class="simple">
<thead>
<tr>
<th>#ID</th>
<th>Case description</th>
<th>Expectation</th>
<th>Execution</th>
<th>Result</th>
<th>Remarks</th>
</tr>
</thead>
<tbody><tr>
<td>GEOM001</td>
<td>Prims</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Polyhedron</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>CRS001</td>
<td>Point in RD</td>
<td>GDAL writes GML point geometry in RD to JSON-FG place attribute</td>
<td>GDAL:: GML &gt; JSON-FG</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>GDAL writes JSON-FG place attribute to GML point geometry</td>
<td>GDAL:: JSON-FG &gt; GML</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>GDAL <em>tolerates</em> to write JSON-FG place attribute to GeoJSON point geometry</td>
<td>GDAL :: JSON-FG &gt; GeoJSON</td>
<td>NOT OK</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Line in RD</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Polygon</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<section id="draft-specification"><div class="header-wrapper"><h3 id="x3-1-draft-specification"><bdi class="secno">3.1 </bdi>Draft specification</h3><a class="self-link" href="#draft-specification" aria-label="Permalink for Section 3.1"></a></div>
<ul>
<li><p>Geometry:</p>
<ul>
<li><p>(Multi)Point, (Multi)Line, Multi(Polygon), GeometryCollection in <em>place</em>
attribute</p>
</li>
<li><p>(Multi)Polyhedron and (Multi)Prism in <em>place</em> attribute</p>
</li>
</ul>
</li>
<li><p>CRS:</p>
<ul>
<li><p>Types:</p>
<ul>
<li><p>WGS'84 (in geometry and place attribute)</p>
</li>
<li><p>RD: 28992</p>
</li>
<li><p>ETRS89: 4258</p>
</li>
<li><p>3857?</p>
</li>
<li><p>900913?</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Temporal:</p>
<ul>
<li><p>CreationDate</p>
</li>
<li><p>tijdstipregistratie</p>
</li>
<li><p>Tijdlijn geldigheid vs. tijdlijn registratie</p>
</li>
</ul>
</li>
<li><p>Feature metadata</p>
<ul>
<li><p>?? Feature schema: JSON schema of BGT?</p>
<ul>
<li>Combine two datasets of BAG and BGT in 1 dataset?</li>
</ul>
</li>
</ul>
</li>
</ul>
</section><section id="gdal-dev-implementation"><div class="header-wrapper"><h3 id="x3-2-gdal-dev-implementation"><bdi class="secno">3.2 </bdi>GDAL-dev implementation</h3><a class="self-link" href="#gdal-dev-implementation" aria-label="Permalink for Section 3.2"></a></div>
<section id="formats-json-fg"><div class="header-wrapper"><h4 id="x3-2-1-formats-json-fg"><bdi class="secno">3.2.1 </bdi>Formats JSON-FG &lt;&gt;:</h4><a class="self-link" href="#formats-json-fg" aria-label="Permalink for Section 3.2.1"></a></div>
<ul>
<li><p>GML</p>
<ul>
<li><p>GeoJSON</p>
<ul>
<li><p>PostgreSQL</p>
<ul>
<li><p>OpenFileGeodatabase (ESRI)</p>
</li>
<li><p>Esri Shapefile</p>
</li>
</ul>
</li>
<li><p>CRS:</p>
<ul>
<li><p>Syntax/Format:</p>
<ul>
<li>URI: "<a href="http://www.opengis.net/def/crs/EPSG/0/28992">http://www.opengis.net/def/crs/EPSG/0/28992</a>"</li>
</ul>
<ol>
<li>SAFE CURIE: "[EPSG: 3857]"</li>
</ol>
</li>
</ul>
</li>
<li><p>Others:</p>
<ul>
<li><p>Arcs?</p>
</li>
<li></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section></section><section id="test-execution"><div class="header-wrapper"><h3 id="x3-3-test-execution"><bdi class="secno">3.3 </bdi>Test execution</h3><a class="self-link" href="#test-execution" aria-label="Permalink for Section 3.3"></a></div>
<ul>
<li><p>Datasets:</p>
<ul>
<li><p>BGT GML (2D RD, and includes ARCs)</p>
<ul>
<li><p>BAG 3D Geopackage (Polyhedrons)</p>
</li>
<li><p>BAG extruded polygons (Prims)</p>
</li>
<li><p>Bestuurlijke gebieden (temporal aspects)</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section></section>
  <section class="informative" id="results"><div class="header-wrapper"><h2 id="x4-results"><bdi class="secno">4. </bdi>Results</h2><a class="self-link" href="#results" aria-label="Permalink for Section 4."></a></div><p><em>This section is non-normative.</em></p>
<p>The complete list of tests and results is available in this [excel file][]. We tested most of the JSON-FG features, and found no issues in the GDAL implementation of it. </p>
<section id="geometry-and-place"><div class="header-wrapper"><h3 id="x4-1-geometry-and-place"><bdi class="secno">4.1 </bdi>Geometry and place</h3><a class="self-link" href="#geometry-and-place" aria-label="Permalink for Section 4.1"></a></div>
<p>The source data contained coordinates in the Dutch coordinate reference system RD. When converting to JSON-FG, by default GDAL: </p>
<ul>
<li>fills the <code>place</code> member with the coordinates as found in the source;</li>
<li>fills the <code>geometry</code> member with WGS84 coordinates.</li>
</ul>
<p>This conforms to the JSON-FG spec, but is not always what you want. Another option is to leave <code>geometry</code> empty (i.e. null value) and only fill the <code>place</code> member. You can instruct GDAL to do that, using the <code>WRITE_GEOMETRY=NO</code> option. </p>
<p>When to fill <code>geometry</code>, and when to give it a null value: </p>
<ul>
<li>When the JSON-FG is a payload of an API, this is clear from the response media type. The client probably asked specifically for JSON-FG, and therefore knows what it is and how to use it. In that case, it's unnecessary to enlarge the payload with <code>geometry</code> members containing converted coordinates. The client probably wants the specific CRS it asked for. If a client wants GeoJSON, with WGS84 coordinates, it can ask for that. </li>
<li>When publishing JSON-FG somewhere outside the context of a webservice/API, it does make sense to fill <code>geometry</code> as well as <code>place</code>. In that case, the user has no context that helps figure out what the file is. There is no mime type or anything like that. In that case, it is good practice to have the fallback geometry, so that the file can be used in GeoJSON clients as well as JSON-FG clients.</li>
</ul>
</section><section id="time"><div class="header-wrapper"><h3 id="x4-2-time"><bdi class="secno">4.2 </bdi>Time</h3><a class="self-link" href="#time" aria-label="Permalink for Section 4.2"></a></div>
<p>The <code>time</code> member initially was filled with a <code>null</code> value by GDAL, because it could not identify the temporal information to use in the source data. There is no specific option in GDAL to point to the right source element. It looks for an element called <code>time</code>, <code>time_start</code>, or <code>time_end</code>. If that's not what it's called in your input, you need to do some remapping. You can do this e.g. with an SQL statement: </p>
<p><code>ogr2ogr out.json test.xml -of jsonfg -sql "select cast (creationDate as date) as time, * from BAK"</code></p>
<p>In the example above, <code>creationDate</code> is the date element in the input we're interested in.</p>
<p>GDAL also writes the original property to <code>properties</code>, which is nice because the information is then not lost to GeoJSON clients (that only read <code>geometry</code> and <code>properties</code>). </p>
</section><section id="featuretype-and-schema"><div class="header-wrapper"><h3 id="x4-3-featuretype-and-schema"><bdi class="secno">4.3 </bdi>featureType and schema</h3><a class="self-link" href="#featuretype-and-schema" aria-label="Permalink for Section 4.3"></a></div>
<p>GDAL takes the featureType value from the element name in the case of GML, and from the column name in the case of GeoPackage. </p>
<p>There is no option to have GDAL write the featureSchema with a URL pointing to a JSON Schema for a feature. We did create a JSON Schema by hand (for <a href="https://github.com/Geonovum/test-ogc-json-fg/blob/main/testdata/bgt/citygml/schema/bak.jschema">BAK features</a>). For purposes of creating a comprehensive example file, we add this manually.</p>
</section><section id="x3d-geometries"><div class="header-wrapper"><h3 id="x4-4-3d-geometries"><bdi class="secno">4.4 </bdi>3D geometries</h3><a class="self-link" href="#x3d-geometries" aria-label="Permalink for Section 4.4"></a></div>
<p>TODO. </p>
</section><section id="sample-output"><div class="header-wrapper"><h3 id="x4-5-sample-output"><bdi class="secno">4.5 </bdi>Sample output</h3><a class="self-link" href="#sample-output" aria-label="Permalink for Section 4.5"></a></div>
<p>A sample file converted from IMGeo GML, containing trash bins the area of the Binnenhof, The Hague is <a href="https://github.com/Geonovum/test-ogc-json-fg/blob/main/testdata/bgt/citygml/bgt_bak.json">here</a>. This has both <code>place</code> and <code>geometry</code> with coordinate values, <code>time</code> element with date values, and only contains 2D point geometries. </p>
</section><section id="client-tests"><div class="header-wrapper"><h3 id="x4-6-client-tests"><bdi class="secno">4.6 </bdi>Client tests</h3><a class="self-link" href="#client-tests" aria-label="Permalink for Section 4.6"></a></div>
<p>We tested the sample output in different clients. </p>
<p>GeoJSON clients:</p>
<ol>
<li>Github file preview. When <code>geometry</code> has coordinate values, this shows a map with point features. When <code>geometry</code> is null, it shows a world map without features. So this works as expected.</li>
<li><a href="https://geojson.io/">geojson.io</a> (mapbox). Result is the same as [1]. </li>
<li>QGIS also works the same; it recognizes features in the file only if <code>geometry</code> has coordinates. It reads <code>properties</code> and ignores JSON-FG specific members.</li>
</ol>
<p>JSON-FG clients: </p>
<ul>
<li>A <a href="https://ivansanchez.gitlab.io/gleo/demos/jsonfg-drag-drop.html">JSON-FG client</a> by Ivan Sanchez from an earlier code sprint is used to demonstrate that the JSON-FG output from GDAL can be visualised in a web browser. This works as expected. The client visualizes the features based on the values of the <code>place</code> member, regardless of the presence or absence of coordinates in the <code>geometry</code> member.</li>
</ul>
</section></section>
  

  <section id="conformance"><div class="header-wrapper"><h2 id="x5-conformance"><bdi class="secno">5. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 5."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p></section>
  <section id="tof"></section>
  <section id="index" class="appendix"><div class="header-wrapper"><h2 id="a-index"><bdi class="secno">A. </bdi>Index</h2><a class="self-link" href="#index" aria-label="Permalink for Appendix A."></a></div><section id="index-defined-here">
    <div class="header-wrapper"><h3 id="a-1-terms-defined-by-this-specification"><bdi class="secno">A.1 </bdi>Terms defined by this specification</h3><a class="self-link" href="#index-defined-here" aria-label="Permalink for Appendix A.1"></a></div>
    <ul class="index">
    
  </ul>
  </section><section id="index-defined-elsewhere">
    <div class="header-wrapper"><h3 id="a-2-terms-defined-by-reference"><bdi class="secno">A.2 </bdi>Terms defined by reference</h3><a class="self-link" href="#index-defined-elsewhere" aria-label="Permalink for Appendix A.2"></a></div>
    <ul class="index">
    
  </ul>
  </section></section>



<p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Geonovum General - Editor's draft</div><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>